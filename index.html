<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<title>Pixel World Lite</title>
<style>
  body { margin: 0; overflow: hidden; background: #87ceeb; }
  canvas { display: block; margin: 0 auto; background: #6b8e23; }
  #inventory {
    position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%);
    background: rgba(0,0,0,0.6); padding: 5px; border-radius: 5px;
    display: flex; gap: 10px;
  }
  .slot {
    width: 40px; height: 40px; border: 2px solid white;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    font-size: 24px;
    color: white;
    user-select: none;
  }
  .selected {
    border-color: yellow;
  }
</style>
</head>
<body>

<canvas id="game" width="800" height="400"></canvas>
<div id="inventory"></div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

const tileSize = 40;
const cols = Math.floor(canvas.width / tileSize);
const rows = Math.floor(canvas.height / tileSize);

const world = [];
const AIR = 0, GRASS = 1, DIRT = 2, STONE = 3;

const blockColors = {
  [AIR]: null,
  [GRASS]: '#228B22',
  [DIRT]: '#8B4513',
  [STONE]: '#888'
};

// Ініціалізація світу: земля + повітря
for(let r = 0; r < rows; r++) {
  world[r] = [];
  for(let c = 0; c < cols; c++) {
    if(r > rows - 3) world[r][c] = DIRT;
    else if (r === rows - 3) world[r][c] = GRASS;
    else world[r][c] = AIR;
  }
}

// Гравець
const player = {
  x: 5 * tileSize,
  y: (rows - 4) * tileSize,
  w: 30,
  h: 35,
  vx: 0,
  vy: 0,
  speed: 5,
  jumping: false,
  grounded: false
};

// Інвентар
const inventory = [GRASS, DIRT, STONE];
let selectedSlot = 0;

const inventoryDiv = document.getElementById('inventory');
function drawInventory() {
  inventoryDiv.innerHTML = '';
  inventory.forEach((block, i) => {
    const slot = document.createElement('div');
    slot.className = 'slot' + (i === selectedSlot ? ' selected' : '');
    slot.textContent = '⬛'; // блок символом
    slot.style.color = blockColors[block] || 'white';
    slot.onclick = () => { selectedSlot = i; drawInventory(); }
    inventoryDiv.appendChild(slot);
  });
}
drawInventory();

// Фізика та керування
const keys = {};
window.addEventListener('keydown', e => { keys[e.key.toLowerCase()] = true; });
window.addEventListener('keyup', e => { keys[e.key.toLowerCase()] = false; });

function isSolid(r,c) {
  return r >= 0 && r < rows && c >= 0 && c < cols && world[r][c] !== AIR;
}

function update() {
  // Горизонтальний рух
  if(keys['a'] || keys['arrowleft']) player.vx = -player.speed;
  else if(keys['d'] || keys['arrowright']) player.vx = player.speed;
  else player.vx = 0;

  // Стрибок
  if((keys['w'] || keys['arrowup'] || keys[' ']) && player.grounded) {
    player.vy = -15;
    player.grounded = false;
  }

  // Гравітація
  player.vy += 1; // гравітація
  if(player.vy > 20) player.vy = 20;

  // Рух по Х
  player.x += player.vx;
  // Колізії по Х
  let leftCol = Math.floor(player.x / tileSize);
  let rightCol = Math.floor((player.x + player.w) / tileSize);
  let topRow = Math.floor(player.y / tileSize);
  let bottomRow = Math.floor((player.y + player.h) / tileSize);

  if(player.vx > 0) {
    if(isSolid(topRow, rightCol) || isSolid(bottomRow, rightCol)) {
      player.x = rightCol * tileSize - player.w - 0.01;
    }
  } else if(player.vx < 0) {
    if(isSolid(topRow, leftCol) || isSolid(bottomRow, leftCol)) {
      player.x = (leftCol + 1) * tileSize + 0.01;
    }
  }

  // Рух по Y
  player.y += player.vy;
  topRow = Math.floor(player.y / tileSize);
  bottomRow = Math.floor((player.y + player.h) / tileSize);

  if(player.vy > 0) {
    if(isSolid(bottomRow, leftCol) || isSolid(bottomRow, rightCol)) {
      player.y = bottomRow * tileSize - player.h - 0.01;
      player.vy = 0;
      player.grounded = true;
      player.jumping = false;
    } else {
      player.grounded = false;
    }
  } else if(player.vy < 0) {
    if(isSolid(topRow, leftCol) || isSolid(topRow, rightCol)) {
      player.y = (topRow + 1) * tileSize + 0.01;
      player.vy = 0;
    }
  }
}

function drawWorld() {
  for(let r = 0; r < rows; r++) {
    for(let c = 0; c < cols; c++) {
      let block = world[r][c];
      if(block !== AIR) {
        ctx.fillStyle = blockColors[block];
        ctx.fillRect(c * tileSize, r * tileSize, tileSize, tileSize);
        ctx.strokeStyle = '#444';
        ctx.strokeRect(c * tileSize, r * tileSize, tileSize, tileSize);
      }
    }
  }
}

function drawPlayer() {
  ctx.fillStyle = '#ff0';
  ctx.fillRect(player.x, player.y, player.w, player.h);
}

function gameLoop() {
  update();
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawWorld();
  drawPlayer();
  requestAnimationFrame(gameLoop);
}

canvas.addEventListener('mousedown', e => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;
  const c = Math.floor(mx / tileSize);
  const r = Math.floor(my / tileSize);

  if(e.button === 0) {
    // ЛКМ - ставити блок
    if(!isSolid(r, c)) {
      world[r][c] = inventory[selectedSlot];
    }
  } else if(e.button === 2) {
    // ПКМ - знищити блок
    if(isSolid(r,c)) {
      world[r][c] = AIR;
    }
  }
});

canvas.addEventListener('contextmenu', e => e.preventDefault());

gameLoop();
</script>
</body>
</html>
