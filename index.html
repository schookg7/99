<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Проста Geometry Dash</title>
  <style>
    body, html {
      margin: 0; padding: 0; overflow: hidden; background: #222;
      user-select: none;
      -webkit-user-select:none;
    }
    canvas {
      display: block; margin: auto; background: #333;
      touch-action: manipulation;
    }
  </style>
</head>
<body>
<canvas id="game" width="800" height="400"></canvas>

<script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  const WIDTH = canvas.width;
  const HEIGHT = canvas.height;

  // Гравець
  const player = {
    x: 50,
    y: HEIGHT - 60,
    width: 40,
    height: 40,
    vy: 0,
    jumpPower: -12,
    gravity: 0.6,
    grounded: false,
    color: '#4caf50'
  };

  // Рівень (платформи)
  // Масив блоків {x, y, width, height}
  // Тут є підлога і кілька перешкод
  const platforms = [
    {x: 0, y: HEIGHT - 20, width: WIDTH*10, height: 20, color: '#888'}, // підлога
    {x: 400, y: HEIGHT - 70, width: 30, height: 50, color: '#e91e63'}, // перешкода
    {x: 600, y: HEIGHT - 90, width: 30, height: 70, color: '#e91e63'},
    {x: 850, y: HEIGHT - 60, width: 30, height: 40, color: '#e91e63'},
    {x: 1100, y: HEIGHT - 100, width: 30, height: 80, color: '#e91e63'}
  ];

  let scrollX = 0;  // Скільки прокручено вправо
  const scrollSpeed = 4; // Швидкість руху вправо

  let score = 0;
  let gameOver = false;

  function rectsCollide(r1, r2) {
    return !(r2.x > r1.x + r1.width || 
             r2.x + r2.width < r1.x || 
             r2.y > r1.y + r1.height ||
             r2.y + r2.height < r1.y);
  }

  // Обробка стрибка (тикання)
  function jump() {
    if(player.grounded && !gameOver) {
      player.vy = player.jumpPower;
      player.grounded = false;
    }
  }

  // Для мобільних і ПК
  canvas.addEventListener('mousedown', jump);
  canvas.addEventListener('touchstart', e => {
    e.preventDefault();
    jump();
  }, {passive:false});

  function update() {
    if(gameOver) return;

    scrollX += scrollSpeed;

    // Рух гравця по вертикалі
    player.vy += player.gravity;
    player.y += player.vy;

    // Перевірка зіткнень з платформами
    player.grounded = false;
    for(let plat of platforms) {
      // Платформи теж "рухаються" вліво
      let platScreenX = plat.x - scrollX;

      if(platScreenX < WIDTH) {
        const platRect = {x: platScreenX, y: plat.y, width: plat.width, height: plat.height};
        const playerRect = {x: player.x, y: player.y, width: player.width, height: player.height};

        if(rectsCollide(playerRect, platRect)) {
          // Просте зіткнення з платформою згори
          if(player.vy > 0 && player.y + player.height <= plat.y + player.vy) {
            player.y = plat.y - player.height;
            player.vy = 0;
            player.grounded = true;

            // Перевірка чи це перешкода
            if(plat.color === '#e91e63') {
              // гравець зіткнувся — кінець гри
              gameOver = true;
            }
          } else {
            // зіткнення збоку або знизу - теж кінець гри
            gameOver = true;
          }
        }
      }
    }

    // Не впадати нижче екрану
    if(player.y > HEIGHT) gameOver = true;

    if(!gameOver) score += 1;
  }

  function draw() {
    ctx.clearRect(0,0,WIDTH,HEIGHT);

    // Малюємо платформи
    for(let plat of platforms) {
      let x = plat.x - scrollX;
      if(x + plat.width >= 0 && x <= WIDTH) {
        ctx.fillStyle = plat.color;
        ctx.fillRect(x, plat.y, plat.width, plat.height);
      }
    }

    // Малюємо гравця
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.width, player.height);

    // Малюємо очки
    ctx.fillStyle = 'white';
    ctx.font = '20px Arial';
    ctx.fillText('Score: ' + score, 10, 30);

    if(gameOver) {
      ctx.fillStyle = 'rgba(0,0,0,0.6)';
      ctx.fillRect(0,0,WIDTH,HEIGHT);
      ctx.fillStyle = 'white';
      ctx.font = '40px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('Game Over', WIDTH/2, HEIGHT/2 - 20);
      ctx.font = '20px Arial';
      ctx.fillText('Тикай, щоб почати знову', WIDTH/2, HEIGHT/2 + 20);
    }
  }

  function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }

  gameLoop();

  // Перезапуск гри по кліку після смерті
  canvas.addEventListener('mousedown', () => {
    if(gameOver) restart();
  });
  canvas.addEventListener('touchstart', e => {
    e.preventDefault();
    if(gameOver) restart();
  }, {passive:false});

  function restart() {
    scrollX = 0;
    score = 0;
    player.y = HEIGHT - 60;
    player.vy = 0;
    player.grounded = false;
    gameOver = false;
  }
</script>
</body>
</html>
